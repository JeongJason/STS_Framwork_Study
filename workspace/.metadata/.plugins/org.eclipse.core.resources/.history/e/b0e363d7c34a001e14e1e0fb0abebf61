<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.board.mapper.ReplyMapper">
		<insert id="insert">
			INSERT INTO TBL_REPLY (RNO,BNO,REPLY,REPLIER)
			VALUES(SEQ_REPLY.NEXTVAL,#{bno},#{reply},#{replier})
		</insert>
		
		<select id="select" resultType="replyVO">
			SELECT RNO,BNO,REPLY,REPLIER,REPLYDATE,UPDATEDATE FROM TBL_REPLY
			WHERE RNO = #{rno}
		</select>
		
		<delete id="delete">
			DELETE FROM TBL_REPLY WHERE RNO=#{rno}
		</delete>
		
		<delete id="deleteAll">
			DELETE FROM TBL_REPLY WHERE BNO=#{bno}
		</delete>
		
		<update id="update">
			UPDATE TBL_REPLY 
			SET REPLY = #{reply},UPDATEDATE = SYSDATE 
			WHERE RNO = #{rno}
		</update>
		
		<select id="selectAll" resultType="replyVO">
			SELECT /*+ INDEX_DESC(TBL_REPLY,PK_REPLY)*/ ROWNUM RN 
			RNO,BNO,REPLY,REPLIER,REPLYDATE,UPDATEDATE
			FROM TBL_REPLY WHERE 
				<![CDATA[	
				ROWNUM <= #{pageNum} * #{amount}
			]]>
			BNO = #{bno}
			
			
				SELECT BNO, TITLE, CONTENT, WRITER, REGDATE, UPDATEDATE
		FROM
		(
		SELECT /*+
		INDEX_DESC(TBL_BOARD, SYS_C007001)*/
		ROWNUM RN, BNO, TITLE, CONTENT,
		WRITER, REGDATE, UPDATEDATE
		FROM TBL_BOARD WHERE
		<include refid="search" />
			<![CDATA[	
				ROWNUM <= #{pageNum} * #{amount}
			]]>
		)
		<![CDATA[
			WHERE RN  > (#{pageNum} - 1) * #{amount}
		]]>
		</select>
		
</mapper>